# KrayGemma

Простая консольная утилита для получения описаний изображений с помощью модели Gemma версии 3 (и, возможно, выше), запущенной в сервере Ollama.

Настройки хранятся в файле `appsettings.json`:

```json
{
  "model": "gemma3:4b",
  "endpoint": "http://localhost:11434/api/chat",
  "russian": "Предоставь полное и подробное описание фотографии, начиная сразу с анализа её содержимого, без использования стандартных вводных фраз. Не используй разметку Markdown.",
  "english": "Provide a complete and detailed description of the photograph, starting immediately with an analysis of its contents, without using standard introductory phrases. Don't use Markdown markup."
}
```

Параметры запуска:

```
KrayGemma <input> <prefix> <output>
```

здесь

* `input` - папка, в которой будет производиться поиск изображений. 
  В качестве изображений распознаются файлы со следующими расширениями
  (независимо от регистра символов):
 
  * '.jpg'
  * '.jpeg'

* `prefix` - префикс, добавляемый к именам файлов, например, `"pic\"`.

* `output` - имя выходного текстового файла, например, `"tags.txt"`.

Пример:

```
KrayGemma G:\Images\fb\fb0008 pic\fn\fn000\ output.txt
```

Выходной файл состоит из блоков по 4 строки:
```
Имя файла изображения с префиксом
Описание на русском языке
Описание на английском языке
Пустая строка
```

Пример выходного файла:

```
pic\fn\fn000\fn000100.jpg
Фотография изображает глубокий, узкий каньон, вероятно, в горной местности. На переднем плане виден массивный, заваленный грудой земли и камней, предположительно, результат оползня или эрозии. Этот завал занимает значительную часть кадра и создает резкий контраст с окружающей средой. Стены каньона, по обеим сторонам завала, образованы отвесными скалами, покрытыми густой, темно-зеленой растительностью. Деревья, в основном хвойные, растут плотно, образуя почти непрерывный полог. В некоторых местах видны отдельные кустарники и травы, пробивающиеся сквозь деревья. В глубине каньона, на горизонте, виднеется еще один, более отдаленный каньон, также с отвесными скалами и растительностью. Он кажется меньше и менее выраженным, чем первый. Небо на фотографии светло-голубое, без облаков, что создает ощущение ясности и чистоты. Свет падает сверху, подчеркивая текстуру скал и растительности. В кадре также видны несколько высоких, деревянных столбов, вероятно, ограждение или предупреждающий знак, установленные вдоль каньона. Они добавляют ощущение масштаба и подчеркивают опасность, связанную с этим местом. Общее впечатление от фотографии – ощущение величия и силы природы, а также потенциальной опасности, которую она представляет. Цветовая гамма – преимущественно зеленые, коричневые и голубые оттенки. 
The photograph depicts a vast, rugged mountainous landscape under a predominantly overcast sky. The dominant feature is a deep, narrow valley carved into the mountainside, likely a river gorge. The valley floor is heavily disturbed, exhibiting significant erosion and deposition, with a large, irregular expanse of reddish-brown sediment – likely mud and debris – covering a substantial portion of the valley bottom. This disturbed area suggests recent or ongoing geological activity, possibly a landslide or significant river channel change. The mountains themselves are steep and heavily forested, primarily with coniferous trees, predominantly pine and fir, judging by the needle-like foliage. The trees are densely packed along the slopes, creating a dark green band against the lighter grey of the rock. The rock faces are predominantly grey and brown, displaying a layered appearance indicative of sedimentary rock formations. There are visible signs of weathering and erosion, with cracks and fissures running across the rock surfaces. A line of utility poles and wires stretches across the foreground, running parallel to the valley wall. These structures are a relatively small element within the immense scale of the landscape, emphasizing the wild and untouched nature of the scene.  The lighting is diffused due to the overcast sky, resulting in relatively even illumination across the entire image. There are no strong shadows, further contributing to the sense of flatness and depth within the valley. The overall impression is one of immense scale, ruggedness, and a sense of geological time. The scene conveys a feeling of isolation and the power of natural forces shaping the landscape.

pic\fn\fn000\fn000101.jpg
На фотографии изображен участок горного ландшафта, вероятно, в высокогорной местности. Преобладающим элементом является густой лес, состоящий в основном из хвойных деревьев, предположительно елей и сосен, с густой темно-зеленой листвой. Деревья плотно расположены, создавая ощущение непроходимой чащи. На переднем плане, непосредственно перед объективом, видна металлическая конструкция – часть линии электропередач. Она представляет собой несколько столбов, соединенных проводами, которые тянутся вглубь изображения. Конструкция выглядит относительно новой и хорошо обслуживаемой. За лесом возвышаются горы. Они имеют скалистые склоны, покрытые снежными вершинами. Снег на вершинах указывает на высокое расположение местности и, вероятно, на низкую среднюю температуру. Цвет гор варьируется от серого и белого до светло-голубого, отражая солнечный свет. Небо на заднем плане чистое, светло-голубое, без облаков. Это создает контраст с темно-зелеными деревьями и снежными вершинами гор. В целом, фотография передает ощущение дикой, нетронутой природы, возможно, в условиях сурового климата. Освещение яркое, что подчеркивает текстуру деревьев и скал. В кадре присутствует ощущение простора и величия горного ландшафта. 
The photograph depicts a dense, coniferous forest stretching into the distance, dominated by tall, slender trees with dark green needles. The trees are tightly packed, creating a solid wall of vegetation. The color palette is primarily dominated by shades of green, ranging from the deep, saturated green of the mature trees to lighter, more vibrant greens in the foreground.  A substantial, dark-colored metal support beam, likely part of a railway or similar structure, occupies the left side of the frame, creating a strong vertical element. It’s positioned close to the foreground, partially obscuring the view. The beam is weathered and shows signs of wear. The forest extends into the background, fading into a hazy, light blue sky. The mountains are visible in the far distance, appearing as a muted, grayish-blue range. The mountains are indistinct due to atmospheric haze and distance.  The lighting is diffused, suggesting an overcast day. There are no strong shadows, indicating a lack of direct sunlight. The overall impression is one of a vast, remote, and somewhat somber landscape. The composition emphasizes the scale and density of the forest, highlighting its imposing presence. The scene feels quiet and undisturbed.

pic\fn\fn000\fn000102.jpg
На переднем плане, занимая значительную часть кадра, расположены четыре высоковольтных электрических столба. Они выполнены в светло-серый цвет и имеют цилиндрическую форму с коническими вершинами. Столбы расположены в ряд, с небольшим расстоянием между ними. На каждом столбе висят несколько проводов, образующих высоковольтные линии электропередач. Провода имеют темно-серый цвет и кажутся тонкими и длинными. За столбами простирается густой, однородный лес. Деревья имеют темно-зеленый цвет и кажутся очень плотно посаженными друг к другу. Ветви деревьев не видны, что создает впечатление единого, непроницаемого полотна. Лес занимает большую часть пространства на заднем плане. На заднем плане возвышается гора. Она имеет темно-серый цвет и покрыта скалами и камнями. Вершина горы нечеткая из-за расстояния и атмосферных условий. Гора занимает значительную часть неба, создавая ощущение ее монументальности. Небо на фотографии светло-голубое, без облаков. Освещение равномерное, без резких теней. В целом, фотография передает ощущение простора и величия природы, а также подчеркивает присутствие человека, создавшего инфраструктуру для передачи электроэнергии. Качество изображения достаточно высокое, детали хорошо просматриваются.
The photograph depicts a dense, almost uniform forest scene dominated by tall, slender coniferous trees. The trees are predominantly a deep, dark green, creating a solid, textured wall that fills the majority of the frame. The foliage is consistently dense, suggesting a mature and undisturbed forest. A single, substantial electrical transmission line cuts diagonally across the center of the image, running from the lower left to the upper right. The line is composed of multiple wires, bundled together and supported by sturdy, dark-colored poles. The poles are spaced relatively closely together, indicating a high-voltage power line. The line’s presence disrupts the otherwise seamless texture of the forest. In the background, a large, rugged mountain range rises sharply. The mountains are composed of gray and brown rock, with patches of snow visible on the higher elevations. The mountains appear somewhat distant, contributing to a sense of depth within the image. The sky is a pale, washed-out blue, suggesting a clear, sunny day. The lighting is bright and even, with no strong shadows. This indicates direct sunlight. The overall impression is one of a vast, remote, and somewhat imposing natural landscape. The composition emphasizes the scale of the forest and the intrusion of human infrastructure within it. The scene evokes a feeling of wilderness and isolation.

pic\fn\fn000\fn000103.jpg
На фотографии изображен вид из окна поезда, движущегося по железнодорожному пути. В поле зрения находится значительная часть локомотива, окрашенного в сине-белые полосы. Перед локомотивом простирается железнодорожная насыпь, состоящая из гранитного щебня, частично покрытого слоем влажного грунта и травы. Насыпь имеет неровный, слегка запущенный вид, с заметными ямами и неровностями. В нижней части кадра, ближе к зрителю, виден небольшой бетонный столб, вероятно, часть железнодорожной инфраструктуры. Насыпь уходит вдаль, где виднеется ряд столбов электропередач, поддерживающих высоковольтные линии. Небо на заднем плане затянуто облаками, что создает рассеянный свет. Внутри локомотива, в поле зрения, виден фрагмент синей обшивки, а также часть окна. Общее впечатление от снимка – типичный пейзаж железнодорожной линии, передающий ощущение движения и скорости. Цветовая гамма – преобладание серых, синих и зеленых оттенков. Фокус изображения четкий, детали хорошо различимы.
The photograph depicts a segment of a train traveling along a rural Russian railway line. The primary subject is the side view of a train car, specifically the right-hand side of a blue carriage. The carriage is predominantly blue with a lighter blue stripe running horizontally along its upper portion. The windows are dark, obscuring the interior. The immediate foreground is dominated by a ballast bed, composed of gravel and small stones, typical of railway tracks. The gravel is a mix of gray, brown, and white, and is unevenly distributed, showing signs of wear and maintenance. A small, grey metal post stands near the track, likely a signal post or support. Beyond the track, a power line runs parallel to the railway, supported by tall, wooden poles. The poles are weathered and appear aged. The sky is overcast and gray, contributing to a muted color palette throughout the image.  The track itself is relatively straight, suggesting a long, open stretch of railway. The overall impression is one of a quiet, rural landscape, with the train representing a small intrusion into the natural environment. The lighting is flat and diffused due to the overcast sky, minimizing shadows and creating a somewhat somber atmosphere. The composition emphasizes the scale of the train against the vastness of the surrounding landscape.

pic\fn\fn000\fn000104.jpg
Фотография изображает внутреннюю часть вагона пассажирского поезда, снятую с перспективы пассажира, смотрящего в окно. В кадре доминирует металлическая обшивка вагона, покрытая следами отпечатков рук и пальцев, что указывает на частое использование. Окно, занимающее большую часть правой части кадра, открывает вид на длинный, прямолинейный участок железнодорожной трассы. Поезд состоит из нескольких вагонов, движущихся в одном направлении. Вагоны имеют одинаковый цвет – светло-серый, и выглядят относительно однотипными. Видна часть переднего вагона, с видимой частью кабины машиниста. Вдоль трассы расположены столбы ЛЭП, поддерживающие контактную сеть. На трассе видны небольшие деревья, что указывает на то, что это, скорее всего, сельская местность. Небо голубое, с небольшими облаками. Вдалеке, на горизонте, виднеется линия, возможно, дорога. В целом, освещение яркое, что говорит о солнечной погоде. В кадре присутствует ощущение движения и скорости. Внутри вагона, на металлической обшивке, заметны следы отпечатков, что добавляет реалистичности и показывает, что вагон активно используется. Вдалеке, на трассе, виднеется небольшая группа деревьев, что указывает на то, что это, скорее всего, сельская местность. Вдалеке, на трассе, виднеется небольшая группа деревьев, что указывает на то, что это, скорее всего, сельская местность. 
The photograph depicts a segment of a long, steel passenger train receding into the distance. The dominant element is the train itself, occupying approximately two-thirds of the frame. The train consists of numerous carriages, each a uniform, dark grey color, tightly packed together. The carriages appear to be of a modern design, with relatively flat roofs and large windows. The train’s movement is evident through the slight blurring of the carriages in the distance, suggesting speed. The train is running along a straight section of track, bordered by a dense forest of predominantly green trees. The trees are a mix of deciduous and coniferous species, creating a textured, layered effect. The forest is a vibrant, healthy green, indicating a warm season. The trees are close to the tracks, creating a sense of confinement and emphasizing the train’s passage.  Above the train, a network of overhead power lines stretches across the sky. These lines are a dark grey color and are spaced evenly, supporting the train’s operation. The sky is a pale blue, partially obscured by the power lines.  The photograph is taken from a moving perspective, likely from a window of a train. The window frame is visible on the left side of the image, a dark grey, slightly weathered, and with a noticeable reflection of the train and surrounding landscape. The overall lighting is bright and diffused, suggesting a sunny day. The focus is sharp on the train and the immediate foreground, with a slight softening of detail in the distant trees. The composition is dominated by horizontal lines – the tracks, the train, and the power lines – creating a sense of movement and scale. The image evokes a feeling of speed, distance, and the industrial landscape of a modern railway.

pic\fn\fn000\fn000105.jpg
Фотография сделана из окна поезда, движущегося по железнодорожному пути, проходящему через густой, зеленый лес. В центре кадра – длинный грузовой состав, состоящий из нескольких вагонов различных типов. В передней части состава, непосредственно перед камерой, находится зеленый грузовой вагон, предположительно для перевозки зерна. Он имеет характерную форму кузова и большое количество креплений для груза. За ним следует длинный состав, состоящий из вагонов различных цветов: синий, серый, коричневый и белый. Вагоны имеют стандартную форму, характерную для советских грузовых вагонов. Некоторые вагоны имеют на боковых сторонах крепления для груза. На переднем плане, прямо на железнодорожном пути, стоит человек в оранжевом жилете, вероятно, железнодорожный работник, который проводит осмотр или ремонт. Он стоит в стороне от состава, чтобы не мешать движению поезда. На заднем плане, за составом, простирается густой, зеленый лес. Деревья кажутся очень высокими и плотно растут вдоль железнодорожного пути. Небо за лесом серое, что указывает на облачность. Поезд движется вперед, что видно по небольшому размытию изображения. По рельсам видны следы от колес. В целом, фотография создает ощущение движения и показывает типичную картину железнодорожного транспорта в России, возможно, в советское время, учитывая внешний вид вагонов и одежду работника. Качество изображения немного снижено, что добавляет фотографии аутентичности.
The photograph depicts a long freight train moving through a heavily forested mountainous landscape. The shot is taken from within a passenger train, looking out through the front windscreen. The dominant feature is a substantial freight train, stretching far into the distance. At the front of the train is a powerful, green locomotive, likely a diesel-electric model, with a prominent number “9” painted on its side. The locomotive is positioned on a slight incline, suggesting a steep grade. It’s painted in a standard dark green color and appears relatively new, with a clean, polished surface. Behind the locomotive, a large number of freight cars are visible, predominantly in shades of blue and grey. The cars are of various types, including boxcars, tank cars (filled with liquid), and flatcars. Many of the cars are stacked closely together, creating a dense line of transport. The blue cars are particularly noticeable, with their distinctive rounded shapes. The track itself is a standard gauge railway, running parallel to the camera. The rails are a dark grey color and appear well-maintained. The ballast, the gravel and stone supporting the tracks, is visible along the sides of the track.  The surrounding environment is a dense, coniferous forest. Tall pine and fir trees dominate the landscape, creating a thick canopy that obscures much of the background. The trees are a deep green color, and the sunlight filters through the branches, creating dappled shadows on the ground. The forest slopes upwards, forming a steep hillside.  The sky is overcast, with a grey, diffused light. There are no clouds visible. The overall impression is one of a remote, industrial scene in a rugged mountain region. The photograph conveys a sense of scale and the importance of rail transport in a challenging terrain. The foreground is dominated by the track and the immediate surroundings of the train, while the background fades into the distant, forested mountains.

```
